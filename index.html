<!DOCTYPE html>
<html lang="id">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Absensi Online</title>
    <style>
        /* Sedikit gaya agar rapi di HP */
        body { font-family: sans-serif; padding: 20px; background: #f4f4f4; }
        form { background: white; padding: 20px; border-radius: 8px; box-shadow: 0 2px 5px rgba(0,0,0,0.1); }
        input, select, textarea { width: 100%; padding: 10px; margin: 5px 0 15px 0; border: 1px solid #ccc; border-radius: 4px; box-sizing: border-box;}
        button { width: 100%; background-color: #4CAF50; color: white; padding: 14px 20px; margin: 8px 0; border: none; border-radius: 4px; cursor: pointer; }
        button:hover { background-color: #45a049; }
        .btn-lokasi { background-color: #2196F3; margin-bottom: 15px; }
        #pesan { margin-top: 15px; font-weight: bold; text-align: center;}
    </style>
</head>
<body>

    <h2 style="text-align:center;">Form Absensi</h2>

    <form name="submit-to-google-sheet">
        
        <label>Nama Lengkap</label>
        <input type="text" name="NAMA" required placeholder="Nama Anda...">

        <label>Tipe Absen</label>
        <select name="TIPE" required>
            <option value="" disabled selected>-- Pilih --</option>
            <option value="Masuk">Masuk</option>
            <option value="Keluar">Keluar</option>
            <option value="Izin">Izin</option>
        </select>

        <label>Keperluan</label>
        <input type="text" name="KEPERLUAN" placeholder="Isi jika Izin/Dinas Luar">

        <label>Lokasi Saya</label>
        <button type="button" class="btn-lokasi" onclick="getLocation()">üìç Ambil Lokasi Saya Otomatis</button>
        <textarea name="LOKASI" id="lokasiInput" required placeholder="Klik tombol biru di atas..."></textarea>

        <button type="submit">KIRIM ABSENSI</button>
    </form>

    <p id="pesan"></p>

    <script>
      // PASTE URL SCRIPT ANDA DI SINI:
      const scriptURL = 'TEMPEL_URL_PANJANG_GOOGLE_APPS_SCRIPT_DISINI'
      
      const form = document.forms['submit-to-google-sheet']
      const pesan = document.getElementById('pesan')

      // Skrip Kirim Data
      form.addEventListener('submit', e => {
        e.preventDefault()
        pesan.innerHTML = "‚è≥ Sedang mengirim data..."
        
        fetch(scriptURL, { method: 'POST', body: new FormData(form)})
          .then(response => {
            pesan.innerHTML = "‚úÖ Berhasil! Data sudah masuk."
            pesan.style.color = "green"
            form.reset()
          })
          .catch(error => {
            pesan.innerHTML = "‚ùå Gagal! Periksa internet Anda."
            pesan.style.color = "red"
            console.error('Error!', error.message)
          })
      })

      // Skrip Ambil Lokasi GPS
            function showPosition(position) {
        // Ambil titik koordinat
        const lat = position.coords.latitude;
        const long = position.coords.longitude;

        // Buat Link Google Maps yang RAPI
        // Format: https://www.google.com/maps?q=LATITUDE,LONGITUDE
        const linkGoogleMaps = "https://www.google.com/maps?q=" + lat + "," + long;
        
        // Masukkan link tersebut ke dalam kotak isian LOKASI
        document.getElementById('lokasiInput').value = linkGoogleMaps;
      }
